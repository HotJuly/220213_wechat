# 区别localStorage,sessionStorage以及cookie

1. 生命周期
   1. cookie
      1. 如果有max-age属性(最大存活时间),只要用户不主动删除,那么存储的数据将永久保留,直到超过最大时间为止
      2. 如果没有max-age属性,那么当前这个cookie就是会话级cookie,如果当前标签页或者浏览器被关闭,那么存储的数据将会丢失
   2. localStorage(持久化存储)
      1. 只要用户不主动删除,那么存储的数据将永久保留
   3. sessionStorage(会话级存储)
      1. 如果当前标签页或者浏览器被关闭,那么存储的数据将会丢失
2. 存储位置
   1. cookie
      1. 如果有max-age属性(最大存活时间),存储于硬盘
      2. 如果没有max-age属性,存储于内存
   2. localStorage
      1. 存储于硬盘
   3. sessionStorage
      1. 存储于内存
3. 存储大小
   1. cookie -> 4KB
   2. localStorage -> 一般是5MB左右,IE浏览器只有3012KB
   3. sessionStorage-> 一般是5MB左右,IE浏览器只有3012KB
4. 与服务器的关系
   1. cookie(被借用的本地存储)
      1. 服务器创建,浏览器存储
         1. 浏览器会自动存储服务器返回的cookie数据,也会自动发送cookie给服务器
      2. 主要都是后端人员为了存储数据而使用的
   2. localStorage
      1. 没有任何关系,他们是浏览器的本地存储,与服务器不熟
   3. sessionStorage
      1. 没有任何关系,他们是浏览器的本地存储,与服务器不熟
5. 作用范围
   1. cookie
      1. domain属性
         1. 假设domain的属性值是qq.com,那么由他衍生出来的子域名都可以访问上级域名的cookie
      2. path属性
         1. 假设path的属性值是/a,那么由他衍生出来的子路由都可以访问上级路由的cookie
      3. 扩展:域名也分层级,地址栏中每有一个.符号,就多一级
         1. 简单来说,子可以读取父的cookie,父不能读取子的cookie
   2. localStorage
      1. 作用范围与网站的域名有关,域名相同的标签页都可以访问存储的数据
   3. sessionStorage
      1. 只能在存储数据的标签页中可见
      2. 扩展:两个标签页之间的内存不互通(除非是复制标签页)
6. 使用场景
   1. cookie
      1. 一般会存放的是服务器想要知道的用户数据,例如:定位信息,购物车信息等
      2. 出现的目的:为了减小服务器的存储成本
   2. localStorage
      1. 如果出现某些数据需要下次开启项目还能继续使用的场景,就选择localStorage
         1. 例如:七天免登陆功能
      2. 如果出现需要跨标签页进行通信,就选择localStorage
   3. sessionStorage
      1. 如果有些数据只是临时使用,那么放入sessionStorage的计算性能远高于localStorage
7. **面试题:如何跨标签页通信?**
   1. **发送数据的页面简称为A页面,接收数据的页面简称为B页面**
   2. **方案一:使用localStorage实现跨标签页通信**
      1. **首先B页面通过绑定事件监听,来监视其余标签页存储localStorage的操作**
         1. **事件源:window**
         2. **事件名:storage**
      2. **A页面通过API向localStorage中存储数据**
         1. **API:localStorage.setItem(key名称,value数据)**
      3. **B页面的事件回调函数会被触发,通过event可以获取到当前存入的localStorage数据**
   3. **方案二:通过URL实现传参**
      1. **流程:**
         1. **在A页面打开B页面的时候,跳转的过程中在页面路径中拼接query参数**
            1. **例如:a标签的href中书写"/about?key=value"**
         2. **B页面渲染之后,获取路径中的参数即可**
            1. **通过location对象即可获取到url中的数据**
8. 扩展:session对象
   1. session对象存储于服务器的内存中
   2. session对象最少具有两个属性,一个是session_ID(就是当前对象的标识),另一个是data(用于存储数据)
   3. 流程:
      1. 服务器在自己的内存中创建一个session对象,并将数据保存在该对象的data属性中
      2. 服务器将session对象的ID传递给浏览器,并存处于浏览器的cookie中
      3. 如果未来浏览器请求服务器,就会自动携带cookie,cookie中就有session对象的id
      4. 最终服务器会根据传过来的session_ID,获取到对应session对象中的data数据,数据可以返回给浏览器或者服务器自己使用
   4. 小总结:其实session和cookie非常相似,只是cookie是将数据保存在浏览器上,而session是将数据保存在服务器上
9. token与上述三者的区别
   1. token的本质:他只是一个字符串
   2. token是数据,他会存储于上述三者中,所以他们之间没有可对比性
   3. token字符串的含义,其实就是根据用户的唯一标识ID经过加密得到的一串乱码数据
      1. 服务器可以根据这个token字符串,可以解密得到用户的唯一标识ID